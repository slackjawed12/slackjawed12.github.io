<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/f2507fe9a69c6606.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-8245b13a1499d92e.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-37d0d0abc9e71e90.js" async="" crossorigin=""></script><script src="/_next/static/chunks/69-ded5788220194a2a.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-eb5b0c2be6bd65a1.js" async="" crossorigin=""></script><script src="/_next/static/chunks/app/posts/%5B...slug%5D/page-4ea92d700db888a1.js" async=""></script><script src="/_next/static/chunks/250-019060243e3dae58.js" async=""></script><script src="/_next/static/chunks/app/page-fb028b9d70e7881b.js" async=""></script><script src="/_next/static/chunks/app/layout-7274d9ef7d2d1f9f.js" async=""></script><title>[Nodejs] CommonJS에서 의존성 올바르게 주입하기</title><meta name="description" content="It covers development stories, and technical stories."/><meta name="naver-site-verification" content="17edbe88d0eda099c70da8802de4604567027c70"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="__className_aaf875 mx-auto max-w-3xl px-6 min-h-full h-auto sm:max-w-6xl sm:px-8"><header><div class="pt-8 flex justify-between"><a href="/"><h1>개발자 이민재입니다.</h1></a><a href="/posts"><span>POSTS</span></a></div><div class="my-8 border border-solid border-slate-500"></div></header><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><article class="prose prose-sm mx-auto max-w-3xl pt-8 dark:prose-invert sm:prose-base lg:prose-lg"><div class="mb-1"><h1 class="text-center">[Nodejs] CommonJS에서 의존성 올바르게 주입하기</h1><div class="align-center flex justify-center gap-5"><time dateTime="2024-04-21T00:00:00.000Z" class="my-auto">April 21, 2024</time><p class="">7<!-- -->min read</p></div></div><h3>Background</h3>
<p>    최근에 회사 API 서버 코드들에 여러 변화를 적용했습니다.
라우터에 모든 로직을 구현하는 기존 방식 대신에, 레이어로 분리된 객체들을 중심으로 로직을 처리하도록 했습니다.
흔히 Controller, Service, Repository로 레이어를 나눠서 개발하는 그 구조로 변경한 것입니다.
이는 Java, Spring에서 개발하던 방식에 익숙한 것도 있었지만,
더 큰 이유는 레이어로 분리했을 때 단위테스트가 더 용이했고, 역할과 책임을 분리해 더 변경하기 쉬운 컴포넌트를 만들 수 있었기 때문입니다.
다만 기존 코드가 Express 프레임워크에 의존하고 있던 터라, 컨트롤러 레이어는 크게 바꾸지 못했고, 서비스 레이어만 약식으로 먼저 도입했습니다.
(컨트롤러 레이어는 데코레이터 패턴을 적용해 wrapping 모듈을 하나 씌워서 상세구현 하나를 숨기는 정도로 멈췄습니다.)<br/>
    이 과정에서 계속 해결하지 못한 문제가 발생했습니다. import한 객체가 계속 undefined로 평가되는 것이었습니다.
이를 해결하기 위해 CommonJS에서 모듈이 로딩되는 방식부터 다시 공부해야했습니다.</p>
<h3>문제상황</h3>
<p>    제가 맞닥뜨렸던 문제를 단순화한 버전입니다.
일단 진입점(index.js)에서 웹서버 컨테이너 역할인 application context를 호출합니다.
Express 프레임워크라면, application context는 Application 객체에 해당합니다.
일반적으로 <code>const app = express()</code>로 호출해서 각종 configuration을 넣는 부분이라고 생각하면 됩니다.
일단 이 프로그램은 모든 컴포넌트를 불러와서, 클라이언트 역할을 하는 클래스의 funcA 메서드만 호출하고 종료합니다.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="javascript" data-theme="github-dark-dimmed"><code data-line-numbers="" data-language="javascript" data-theme="github-dark-dimmed" style="display:grid" data-line-numbers-max-digits="2" class="code-highlight"><span class="code-line line-number" line="1"><span data-line=""><span style="color:#768390">// index.js</span></span>
</span><span class="code-line line-number" line="2"><span data-line=""><span style="color:#F47067">const</span><span style="color:#ADBAC7"> { </span><span style="color:#6CB6FF">ApplicationContext</span><span style="color:#ADBAC7"> } </span><span style="color:#F47067">=</span><span style="color:#DCBDFB"> require</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;./app&quot;</span><span style="color:#ADBAC7">);</span></span>
</span><span class="code-line line-number" line="3"><span data-line=""> </span>
</span><span class="code-line line-number" line="4"><span data-line=""><span style="color:#DCBDFB">ApplicationContext</span><span style="color:#ADBAC7">();</span></span>
</span><span class="code-line line-number" line="5"><span data-line=""> </span>
</span><span class="code-line line-number" line="6"><span data-line=""><span style="color:#768390">// app.js - entry point of application</span></span>
</span><span class="code-line line-number" line="7"><span data-line=""><span style="color:#ADBAC7">console.</span><span style="color:#DCBDFB">log</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;application launch&quot;</span><span style="color:#ADBAC7">);</span></span>
</span><span class="code-line line-number" line="8"><span data-line=""><span style="color:#768390">// load all component</span></span>
</span><span class="code-line line-number" line="9"><span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> Classes</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> require</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;./module&quot;</span><span style="color:#ADBAC7">);</span></span>
</span><span class="code-line line-number" line="10"><span data-line=""> </span>
</span><span class="code-line line-number" line="11"><span data-line=""><span style="color:#F47067">function</span><span style="color:#DCBDFB"> ApplicationContext</span><span style="color:#ADBAC7">() {</span></span>
</span><span class="code-line line-number" line="12"><span data-line=""><span style="color:#F47067">  const</span><span style="color:#6CB6FF"> classInstance</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> Classes.Client;</span></span>
</span><span class="code-line line-number" line="13"><span data-line=""><span style="color:#ADBAC7">  console.</span><span style="color:#DCBDFB">log</span><span style="color:#ADBAC7">(classInstance.</span><span style="color:#DCBDFB">funcA</span><span style="color:#ADBAC7">());</span></span>
</span><span class="code-line line-number" line="14"><span data-line=""><span style="color:#ADBAC7">}</span></span>
</span><span class="code-line line-number" line="15"><span data-line=""> </span>
</span><span class="code-line line-number" line="16"><span data-line=""><span style="color:#6CB6FF">module</span><span style="color:#ADBAC7">.</span><span style="color:#6CB6FF">exports</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> { ApplicationContext };</span></span></span></code></pre></figure>
<p>    여기서 서버의 building block인 컴포넌트를 불러오는 부분을 살펴보겠습니다.
module.js는 컴포넌트들을 인스턴스(싱글톤 객체)로 만들어주는 역할을 합니다.
client는 server의 메서드를 사용합니다. 즉, client는 server에 의존합니다.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="javascript" data-theme="github-dark-dimmed"><code data-language="javascript" data-theme="github-dark-dimmed" style="display:grid" class="code-highlight"><span class="code-line"><span data-line=""><span style="color:#768390">// module.js</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">console.</span><span style="color:#DCBDFB">log</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;server modules loaded&quot;</span><span style="color:#ADBAC7">);</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> _Server</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> require</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;./server&quot;</span><span style="color:#ADBAC7">);</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> _Client</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> require</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;./client&quot;</span><span style="color:#ADBAC7">);</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> Server</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#DCBDFB"> _Server</span><span style="color:#ADBAC7">();</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> Client</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#DCBDFB"> _Client</span><span style="color:#ADBAC7">();</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#6CB6FF">module</span><span style="color:#ADBAC7">.</span><span style="color:#6CB6FF">exports</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> {</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">  Client,</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">  Server,</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">};</span></span>
</span><span class="code-line"><span data-line=""> </span>
</span><span class="code-line"><span data-line=""><span style="color:#768390">// server.js</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">class</span><span style="color:#F69D50"> Server</span><span style="color:#ADBAC7"> {</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F69D50">  serverField</span><span style="color:#ADBAC7">;</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">  constructor</span><span style="color:#ADBAC7">() {</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">    console.</span><span style="color:#DCBDFB">log</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;server instantiate&quot;</span><span style="color:#ADBAC7">);</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#6CB6FF">    this</span><span style="color:#ADBAC7">.serverField </span><span style="color:#F47067">=</span><span style="color:#6CB6FF"> 1</span><span style="color:#ADBAC7">;</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">  }</span></span>
</span><span class="code-line"><span data-line=""> </span>
</span><span class="code-line"><span data-line=""><span style="color:#DCBDFB">  funcB</span><span style="color:#ADBAC7">() {</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">    return</span><span style="color:#6CB6FF"> this</span><span style="color:#ADBAC7">.serverField;</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">  }</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">}</span></span>
</span><span class="code-line"><span data-line=""> </span>
</span><span class="code-line"><span data-line=""><span style="color:#6CB6FF">module</span><span style="color:#ADBAC7">.</span><span style="color:#6CB6FF">exports</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> Server;</span></span>
</span><span class="code-line"><span data-line=""> </span>
</span><span class="code-line"><span data-line=""><span style="color:#768390">// client.js</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">const</span><span style="color:#ADBAC7"> { </span><span style="color:#6CB6FF">Server</span><span style="color:#ADBAC7"> } </span><span style="color:#F47067">=</span><span style="color:#DCBDFB"> require</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;./module&quot;</span><span style="color:#ADBAC7">);</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">class</span><span style="color:#F69D50"> Client</span><span style="color:#ADBAC7"> {</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">  constructor</span><span style="color:#ADBAC7">() {</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">    console.</span><span style="color:#DCBDFB">log</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;client instantiate&quot;</span><span style="color:#ADBAC7">);</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">  }</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#DCBDFB">  funcA</span><span style="color:#ADBAC7">() {</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">    return</span><span style="color:#ADBAC7"> Server.</span><span style="color:#DCBDFB">funcB</span><span style="color:#ADBAC7">();</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">  }</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">}</span></span>
</span><span class="code-line"><span data-line=""> </span>
</span><span class="code-line"><span data-line=""><span style="color:#6CB6FF">module</span><span style="color:#ADBAC7">.</span><span style="color:#6CB6FF">exports</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> Client;</span></span></span></code></pre></figure>
<p>    여기서 출력 결과는 다음과 같습니다.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="bash" data-theme="github-dark-dimmed"><code data-language="bash" data-theme="github-dark-dimmed" style="display:grid" class="code-highlight"><span class="code-line"><span data-line=""><span style="color:#F69D50">application</span><span style="color:#96D0FF"> launch</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F69D50">sevice</span><span style="color:#96D0FF"> module</span><span style="color:#96D0FF"> loaded</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F69D50">server</span><span style="color:#96D0FF"> instantiate</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F69D50">client</span><span style="color:#96D0FF"> instantiate</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F69D50">/path/client.js:8</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">    return</span><span style="color:#96D0FF"> Server.funcB</span><span style="color:#ADBAC7">();</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F69D50">                  ^</span></span>
</span><span class="code-line"><span data-line=""> </span>
</span><span class="code-line"><span data-line=""><span style="color:#F69D50">TypeError:</span><span style="color:#96D0FF"> Cannot</span><span style="color:#96D0FF"> read</span><span style="color:#96D0FF"> properties</span><span style="color:#96D0FF"> of</span><span style="color:#96D0FF"> undefined</span><span style="color:#ADBAC7"> (reading </span><span style="color:#96D0FF">&#x27;funcB&#x27;</span><span style="color:#ADBAC7">)</span></span></span></code></pre></figure>
<p>    즉, 해당 오류는 클라이언트가 로드한 서버 인스턴스는 메서드 호출시점에 undefined라는 것을 말해줍니다.
이는 module.js에서 클라이언트를 로드하는 과정에서 생길 수 밖에 없었던 오류입니다.
module.js와 client.js는 <strong>순환의존 관계</strong>이기 때문입니다.
즉, module은 client 인스턴스를 만들고, client는 module의 서버 인스턴스를 참조합니다.
그런데 서버 인스턴스는 아직 module 스크립트에서 인스턴스가 되기 전입니다.
이 경우 commonjs에서 순환의존성이 있을 경우 초기화되기 전 객체는 undefined로 처리합니다.</p>
<h3>해결책</h3>
<p>    먼저 모듈 간 순환의존성이 발생하는 부분을 찾으려면 madge 패키지같은 모듈의존성 시각화 도구를 사용해주면 좋습니다.
이런 종류의 에러는 발생한 후에도 원인을 찾기 힘들고, 발생 전에도 예측하기 힘들기 때문입니다.
아래 명령어로 magde를 실행해주면 순환의존성을 찾아줍니다.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="bash" data-theme="github-dark-dimmed"><code data-language="bash" data-theme="github-dark-dimmed" style="display:grid" class="code-highlight"><span class="code-line"><span data-line=""><span style="color:#F69D50">$</span><span style="color:#96D0FF"> npx</span><span style="color:#96D0FF"> madge</span><span style="color:#6CB6FF"> --circular</span><span style="color:#ADBAC7"> [path]</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#768390">## typescript인 경우</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F69D50">$</span><span style="color:#96D0FF"> npx</span><span style="color:#96D0FF"> madge</span><span style="color:#6CB6FF"> --ts-config</span><span style="color:#96D0FF"> ./tsconfig.json</span><span style="color:#6CB6FF"> --circular</span><span style="color:#ADBAC7"> [path]</span></span></span></code></pre></figure>
<p>    이제 순환 의존성을 깨는 방법 중 하나는, 두 의존성이 클래스인 경우 생성자로 의존성을 주입시키는 것입니다.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#22272e;color:#adbac7" tabindex="0" data-language="javascript" data-theme="github-dark-dimmed"><code data-language="javascript" data-theme="github-dark-dimmed" style="display:grid" class="code-highlight"><span class="code-line"><span data-line=""><span style="color:#768390">// module.js</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">console.</span><span style="color:#DCBDFB">log</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;server modules loaded&quot;</span><span style="color:#ADBAC7">);</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> _Server</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> require</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;./server&quot;</span><span style="color:#ADBAC7">);</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> _Client</span><span style="color:#F47067"> =</span><span style="color:#DCBDFB"> require</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;./client&quot;</span><span style="color:#ADBAC7">);</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> Server</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#DCBDFB"> _Server</span><span style="color:#ADBAC7">();</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#768390">// dependency injection</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">const</span><span style="color:#6CB6FF"> Client</span><span style="color:#F47067"> =</span><span style="color:#F47067"> new</span><span style="color:#DCBDFB"> _Client</span><span style="color:#ADBAC7">(Server);</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#6CB6FF">module</span><span style="color:#ADBAC7">.</span><span style="color:#6CB6FF">exports</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> {</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">  Client,</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">  Server,</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">};</span></span>
</span><span class="code-line"><span data-line=""> </span>
</span><span class="code-line"><span data-line=""><span style="color:#768390">// server.js</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">class</span><span style="color:#F69D50"> Server</span><span style="color:#ADBAC7"> {</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F69D50">  serverField</span><span style="color:#ADBAC7">;</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">  constructor</span><span style="color:#ADBAC7">() {</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">    console.</span><span style="color:#DCBDFB">log</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;server instantiate&quot;</span><span style="color:#ADBAC7">);</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#6CB6FF">    this</span><span style="color:#ADBAC7">.serverField </span><span style="color:#F47067">=</span><span style="color:#6CB6FF"> 1</span><span style="color:#ADBAC7">;</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">  }</span></span>
</span><span class="code-line"><span data-line=""> </span>
</span><span class="code-line"><span data-line=""><span style="color:#DCBDFB">  funcB</span><span style="color:#ADBAC7">() {</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">    return</span><span style="color:#6CB6FF"> this</span><span style="color:#ADBAC7">.serverField;</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">  }</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">}</span></span>
</span><span class="code-line"><span data-line=""> </span>
</span><span class="code-line"><span data-line=""><span style="color:#6CB6FF">module</span><span style="color:#ADBAC7">.</span><span style="color:#6CB6FF">exports</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> Server;</span></span>
</span><span class="code-line"><span data-line=""> </span>
</span><span class="code-line"><span data-line=""><span style="color:#768390">// client.js</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">const</span><span style="color:#ADBAC7"> { </span><span style="color:#6CB6FF">Server</span><span style="color:#ADBAC7"> } </span><span style="color:#F47067">=</span><span style="color:#DCBDFB"> require</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;./module&quot;</span><span style="color:#ADBAC7">);</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">class</span><span style="color:#F69D50"> Client</span><span style="color:#ADBAC7"> {</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F69D50">  server</span><span style="color:#ADBAC7">;</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">  constructor</span><span style="color:#ADBAC7">(</span><span style="color:#F69D50">server</span><span style="color:#ADBAC7">) {</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">    console.</span><span style="color:#DCBDFB">log</span><span style="color:#ADBAC7">(</span><span style="color:#96D0FF">&quot;client instantiate&quot;</span><span style="color:#ADBAC7">);</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#6CB6FF">    this</span><span style="color:#ADBAC7">.server</span><span style="color:#F47067">=</span><span style="color:#ADBAC7">server;</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">  }</span></span>
</span><span class="code-line"><span data-line=""> </span>
</span><span class="code-line"><span data-line=""><span style="color:#DCBDFB">  funcA</span><span style="color:#ADBAC7">() {</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#F47067">    return</span><span style="color:#6CB6FF"> this</span><span style="color:#ADBAC7">.server.</span><span style="color:#DCBDFB">funcB</span><span style="color:#ADBAC7">();</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">  }</span></span>
</span><span class="code-line"><span data-line=""><span style="color:#ADBAC7">}</span></span>
</span><span class="code-line"><span data-line=""> </span>
</span><span class="code-line"><span data-line=""><span style="color:#6CB6FF">module</span><span style="color:#ADBAC7">.</span><span style="color:#6CB6FF">exports</span><span style="color:#F47067"> =</span><span style="color:#ADBAC7"> Client;</span></span></span></code></pre></figure>
<p>    사실 가장 바람직한 해결책은 스프링같은 DI 컨테이너를 사용하는 것입니다.
매번 개발자가 이걸 신경쓰면서 의존성을 관리하면 레이어를 분리하는 것이 더 큰 비용이기 때문입니다.
JS 쪽에서는 nest.js를 사용하면 되겠습니다.</p>
<h3>References</h3>
<p><a href="https://velog.io/@egoavara/commonjs%EC%97%90%EC%84%9C-%EB%AA%A8%EB%93%88-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0%EC%97%90%EC%84%9C-%EC%83%9D%EA%B8%B8-%EC%88%98-%EC%9E%88%EB%8A%94-%EC%97%90%EB%9F%AC" rel="noopener noreferrer" target="_blank">commonjs 내부 동작 분석하신 글</a></p><section></section></article><footer class="py-5 relative translate-y-full"><div class="flex flex-row space-x-2 mb-1"><a href="https://github.com/slackjawed12"><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a href="https://linkedin.com/in/minjae-lee-6851592a0"><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="18" height="18"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a></div><div class="flex justify-start"><a class="text-sm sm:text-base" href="/">© <!-- -->2023-2024<!-- --> Lee MinJae blog </a><span class="text-sm sm:text-base">Powered By </span><span class="text-sm sm:text-base">Next.js</span></div></footer><script src="/_next/static/chunks/webpack-8245b13a1499d92e.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/css/f2507fe9a69c6606.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L3\"\n"])</script><script>self.__next_f.push([1,"4:I[7690,[],\"\"]\n6:I[1142,[\"49\",\"static/chunks/app/posts/%5B...slug%5D/page-4ea92d700db888a1.js\"],\"\"]\n7:I[5613,[],\"\"]\n9:I[1778,[],\"\"]\na:I[5250,[\"250\",\"static/chunks/250-019060243e3dae58.js\",\"931\",\"static/chunks/app/page-fb028b9d70e7881b.js\"],\"\"]\nb:I[4840,[\"250\",\"static/chunks/250-019060243e3dae58.js\",\"185\",\"static/chunks/app/layout-7274d9ef7d2d1f9f.js\"],\"Providers\"]\nd:I[8955,[],\"\"]\n8:[\"slug\",\"nodejs/import-and-dependency-injection\",\"c\"]\ne:[]\n"])</script><script>self.__next_f.push([1,"3:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f2507fe9a69c6606.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L4\",null,{\"buildId\":\"K_J6xgnznkxVCkmOF827s\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/nodejs/import-and-dependency-injection\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"nodejs/import-and-dependency-injection\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"nodejs\\\",\\\"import-and-dependency-injection\\\"]}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"nodejs/import-and-dependency-injection\",\"c\"],{\"children\":[\"__PAGE__\",{},[\"$L5\",[\"$\",\"article\",null,{\"className\":\"prose prose-sm mx-auto max-w-3xl pt-8 dark:prose-invert sm:prose-base lg:prose-lg\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-1\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-center\",\"children\":\"[Nodejs] CommonJS에서 의존성 올바르게 주입하기\"}],[\"$\",\"div\",null,{\"className\":\"align-center flex justify-center gap-5\",\"children\":[[\"$\",\"time\",null,{\"dateTime\":\"2024-04-21T00:00:00.000Z\",\"className\":\"my-auto\",\"children\":\"April 21, 2024\"}],[\"$\",\"p\",null,{\"className\":\"\",\"children\":[7,\"min read\"]}]]}]]}],[[\"$\",\"h3\",null,{\"children\":\"Background\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"    최근에 회사 API 서버 코드들에 여러 변화를 적용했습니다.\\n라우터에 모든 로직을 구현하는 기존 방식 대신에, 레이어로 분리된 객체들을 중심으로 로직을 처리하도록 했습니다.\\n흔히 Controller, Service, Repository로 레이어를 나눠서 개발하는 그 구조로 변경한 것입니다.\\n이는 Java, Spring에서 개발하던 방식에 익숙한 것도 있었지만,\\n더 큰 이유는 레이어로 분리했을 때 단위테스트가 더 용이했고, 역할과 책임을 분리해 더 변경하기 쉬운 컴포넌트를 만들 수 있었기 때문입니다.\\n다만 기존 코드가 Express 프레임워크에 의존하고 있던 터라, 컨트롤러 레이어는 크게 바꾸지 못했고, 서비스 레이어만 약식으로 먼저 도입했습니다.\\n(컨트롤러 레이어는 데코레이터 패턴을 적용해 wrapping 모듈을 하나 씌워서 상세구현 하나를 숨기는 정도로 멈췄습니다.)\",[\"$\",\"br\",null,{}],\"\\n    이 과정에서 계속 해결하지 못한 문제가 발생했습니다. import한 객체가 계속 undefined로 평가되는 것이었습니다.\\n이를 해결하기 위해 CommonJS에서 모듈이 로딩되는 방식부터 다시 공부해야했습니다.\"]}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"문제상황\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"    제가 맞닥뜨렸던 문제를 단순화한 버전입니다.\\n일단 진입점(index.js)에서 웹서버 컨테이너 역할인 application context를 호출합니다.\\nExpress 프레임워크라면, application context는 Application 객체에 해당합니다.\\n일반적으로 \",[\"$\",\"code\",null,{\"children\":\"const app = express()\"}],\"로 호출해서 각종 configuration을 넣는 부분이라고 생각하면 됩니다.\\n일단 이 프로그램은 모든 컴포넌트를 불러와서, 클라이언트 역할을 하는 클래스의 funcA 메서드만 호출하고 종료합니다.\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-line-numbers\":\"\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"data-line-numbers-max-digits\":\"2\",\"className\":\"code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// index.js\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"ApplicationContext\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" require\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"./app\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"ApplicationContext\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"();\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// app.js - entry point of application\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"7\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"console.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"application launch\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"8\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// load all component\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"9\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" Classes\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" require\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"./module\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"10\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"11\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" ApplicationContext\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"() {\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"12\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" classInstance\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" Classes.Client;\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"13\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  console.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(classInstance.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"funcA\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"());\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"14\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"}\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"15\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"16\",\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"module\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"exports\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" { ApplicationContext };\"}]]}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"    여기서 서버의 building block인 컴포넌트를 불러오는 부분을 살펴보겠습니다.\\nmodule.js는 컴포넌트들을 인스턴스(싱글톤 객체)로 만들어주는 역할을 합니다.\\nclient는 server의 메서드를 사용합니다. 즉, client는 server에 의존합니다.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"className\":\"code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// module.js\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"console.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"server modules loaded\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" _Server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" require\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"./server\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" _Client\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" require\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"./client\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" Server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" _Server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"();\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" Client\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" _Client\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"();\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"module\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"exports\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  Client,\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  Server,\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"};\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// server.js\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"class\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" Server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"  serverField\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\";\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  constructor\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"() {\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    console.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"server instantiate\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"    this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".serverField \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\";\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  }\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"  funcB\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"() {\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".serverField;\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  }\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"}\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"module\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"exports\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" Server;\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// client.js\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"Server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" require\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"./module\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"class\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" Client\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  constructor\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"() {\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    console.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"client instantiate\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  }\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"  funcA\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"() {\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" Server.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"funcB\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"();\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  }\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"}\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"module\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"exports\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" Client;\"}]]}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"    여기서 출력 결과는 다음과 같습니다.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"bash\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"bash\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"className\":\"code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"application\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" launch\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"sevice\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" module\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" loaded\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" instantiate\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"client\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" instantiate\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"/path/client.js:8\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" Server.funcB\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"();\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"                  ^\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"TypeError:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" Cannot\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" read\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" properties\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" of\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" undefined\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" (reading \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"'funcB'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\")\"}]]}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"    즉, 해당 오류는 클라이언트가 로드한 서버 인스턴스는 메서드 호출시점에 undefined라는 것을 말해줍니다.\\n이는 module.js에서 클라이언트를 로드하는 과정에서 생길 수 밖에 없었던 오류입니다.\\nmodule.js와 client.js는 \",[\"$\",\"strong\",null,{\"children\":\"순환의존 관계\"}],\"이기 때문입니다.\\n즉, module은 client 인스턴스를 만들고, client는 module의 서버 인스턴스를 참조합니다.\\n그런데 서버 인스턴스는 아직 module 스크립트에서 인스턴스가 되기 전입니다.\\n이 경우 commonjs에서 순환의존성이 있을 경우 초기화되기 전 객체는 undefined로 처리합니다.\"]}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"해결책\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"    먼저 모듈 간 순환의존성이 발생하는 부분을 찾으려면 madge 패키지같은 모듈의존성 시각화 도구를 사용해주면 좋습니다.\\n이런 종류의 에러는 발생한 후에도 원인을 찾기 힘들고, 발생 전에도 예측하기 힘들기 때문입니다.\\n아래 명령어로 magde를 실행해주면 순환의존성을 찾아줍니다.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"bash\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"bash\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"className\":\"code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"$$\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" npx\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" madge\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" --circular\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" [path]\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"## typescript인 경우\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"$$\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" npx\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" madge\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" --ts-config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\" ./tsconfig.json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" --circular\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" [path]\"}]]}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"    이제 순환 의존성을 깨는 방법 중 하나는, 두 의존성이 클래스인 경우 생성자로 의존성을 주입시키는 것입니다.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#22272e\",\"color\":\"#adbac7\"},\"tabIndex\":\"0\",\"data-language\":\"javascript\",\"data-theme\":\"github-dark-dimmed\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"javascript\",\"data-theme\":\"github-dark-dimmed\",\"style\":{\"display\":\"grid\"},\"className\":\"code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// module.js\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"console.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"server modules loaded\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" _Server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" require\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"./server\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" _Client\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" require\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"./client\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" Server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" _Server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"();\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// dependency injection\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" Client\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" _Client\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(Server);\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"module\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"exports\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  Client,\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  Server,\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"};\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// server.js\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"class\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" Server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"  serverField\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\";\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  constructor\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"() {\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    console.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"server instantiate\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"    this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".serverField \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\";\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  }\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"  funcB\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"() {\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".serverField;\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  }\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"}\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"module\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"exports\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" Server;\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#768390\"},\"children\":\"// client.js\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"Server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\" require\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"./module\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"class\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\" Client\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" {\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"  server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\";\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"  constructor\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F69D50\"},\"children\":\"server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\") {\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"    console.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#96D0FF\"},\"children\":\"\\\"client instantiate\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\");\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"    this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"server;\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  }\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"  funcA\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"() {\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\" this\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".server.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#DCBDFB\"},\"children\":\"funcB\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"();\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"  }\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\"}\"}]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"module\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6CB6FF\"},\"children\":\"exports\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F47067\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#ADBAC7\"},\"children\":\" Client;\"}]]}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"    사실 가장 바람직한 해결책은 스프링같은 DI 컨테이너를 사용하는 것입니다.\\n매번 개발자가 이걸 신경쓰면서 의존성을 관리하면 레이어를 분리하는 것이 더 큰 비용이기 때문입니다.\\nJS 쪽에서는 nest.js를 사용하면 되겠습니다.\"}],\"\\n\",[\"$\",\"h3\",null,{\"children\":\"References\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://velog.io/@egoavara/commonjs%EC%97%90%EC%84%9C-%EB%AA%A8%EB%93%88-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0%EC%97%90%EC%84%9C-%EC%83%9D%EA%B8%B8-%EC%88%98-%EC%9E%88%EB%8A%94-%EC%97%90%EB%9F%AC\",\"rel\":\"noopener noreferrer\",\"target\":\"_blank\",\"children\":\"commonjs 내부 동작 분석하신 글\"}]}]],[\"$\",\"$L6\",null,{}]]}],null]]},[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",\"$8\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__className_aaf875 mx-auto max-w-3xl px-6 min-h-full h-auto sm:max-w-6xl sm:px-8\",\"children\":[[\"$\",\"header\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"pt-8 flex justify-between\",\"children\":[[\"$\",\"$La\",null,{\"href\":\"/\",\"children\":[\"$\",\"h1\",null,{\"children\":\"개발자 이민재입니다.\"}]}],[\"$\",\"$La\",null,{\"href\":\"/posts\",\"children\":[\"$\",\"span\",null,{\"children\":\"POSTS\"}]}]]}],[\"$\",\"div\",null,{\"className\":\"my-8 border border-solid border-slate-500\"}]]}],[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]}],[\"$\",\"footer\",null,{\"className\":\"py-5 relative translate-y-full\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-row space-x-2 mb-1\",\"children\":[[\"$\",\"a\",null,{\"href\":\"https://github.com/slackjawed12\",\"children\":[\"$\",\"svg\",null,{\"role\":\"img\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"fill\":\"currentColor\",\"className\":\"$undefined\",\"width\":18,\"height\":18,\"children\":[[\"$\",\"title\",null,{\"children\":\"GitHub\"}],[\"$\",\"path\",null,{\"d\":\"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12\"}]]}]}],[\"$\",\"a\",null,{\"href\":\"https://linkedin.com/in/minjae-lee-6851592a0\",\"children\":[\"$\",\"svg\",null,{\"role\":\"img\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 24 24\",\"fill\":\"currentColor\",\"className\":\"$undefined\",\"width\":18,\"height\":18,\"children\":[[\"$\",\"title\",null,{\"children\":\"LinkedIn\"}],[\"$\",\"path\",null,{\"d\":\"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z\"}]]}]}]]}],[\"$\",\"div\",null,{\"className\":\"flex justify-start\",\"children\":[[\"$\",\"$La\",null,{\"href\":\"/\",\"className\":\"text-sm sm:text-base\",\"children\":[\"© \",\"2023-2024\",\" Lee MinJae blog \"]}],[\"$\",\"span\",null,{\"className\":\"text-sm sm:text-base\",\"children\":\"Powered By \"}],[\"$\",\"span\",null,{\"className\":\"text-sm sm:text-base\",\"children\":\"Next.js\"}]]}]]}]]}]}],null]],\"initialHead\":[false,\"$Lc\"],\"globalErrorComponent\":\"$d\",\"missingSlots\":\"$We\"}]]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"[Nodejs] CommonJS에서 의존성 올바르게 주입하기\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"It covers development stories, and technical stories.\"}],[\"$\",\"meta\",\"4\",{\"name\":\"naver-site-verification\",\"content\":\"17edbe88d0eda099c70da8802de4604567027c70\"}],[\"$\",\"meta\",\"5\",{\"name\":\"next-size-adjust\"}]]\n5:null\n"])</script><script>self.__next_f.push([1,""])</script></body></html>